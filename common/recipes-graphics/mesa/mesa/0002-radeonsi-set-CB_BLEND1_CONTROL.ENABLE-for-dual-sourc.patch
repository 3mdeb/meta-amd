From 3f6039e2e1fd5504ec4971f68b0ec09b3b7899f8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Marek=20Ol=C5=A1=C3=A1k?= <marek.olsak@amd.com>
Date: Sat, 26 Nov 2016 15:43:39 +0100
Subject: [PATCH 2/3] radeonsi: set CB_BLEND1_CONTROL.ENABLE for dual source
 blending

Signed-off-by: Avinash M N <avimn@amd.com>
---
 src/gallium/drivers/radeonsi/si_state.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/gallium/drivers/radeonsi/si_state.c b/src/gallium/drivers/radeonsi/si_state.c
index d71be56..349bcaa 100644
--- a/src/gallium/drivers/radeonsi/si_state.c
+++ b/src/gallium/drivers/radeonsi/si_state.c
@@ -462,6 +462,10 @@ static void *si_create_blend_state_mode(struct pipe_context *ctx,
 
 		/* Only set dual source blending for MRT0 to avoid a hang. */
 		if (i >= 1 && blend->dual_src_blend) {
+			/* Vulkan does this for dual source blending. */
+			if (i == 1)
+				blend_cntl |= S_028780_ENABLE(1);
+
 			si_pm4_set_reg(pm4, R_028780_CB_BLEND0_CONTROL + i * 4, blend_cntl);
 			continue;
 		}
-- 
2.7.4

