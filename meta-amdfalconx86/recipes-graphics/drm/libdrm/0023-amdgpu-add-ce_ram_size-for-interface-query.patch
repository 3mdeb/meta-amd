From a3e0796996ac02f795bd9bfbbd72a83bd82a55a6 Mon Sep 17 00:00:00 2001
From: Ken Wang <Qingqing.Wang@amd.com>
Date: Wed, 3 Jun 2015 17:21:27 +0800
Subject: [PATCH 23/67] amdgpu: add ce_ram_size for interface query

Signed-off-by: Ken Wang <Qingqing.Wang@amd.com>
Reviewed-by: Jammy Zhou <Jammy.Zhou@amd.com>
Signed-off-by: Arindam Nath <arindam.nath@amd.com>
---
 amdgpu/amdgpu.h          | 2 ++
 amdgpu/amdgpu_gpu_info.c | 1 +
 include/drm/amdgpu_drm.h | 2 ++
 3 files changed, 5 insertions(+)

diff --git a/amdgpu/amdgpu.h b/amdgpu/amdgpu.h
index 94fc647..302f1dc 100644
--- a/amdgpu/amdgpu.h
+++ b/amdgpu/amdgpu.h
@@ -520,6 +520,8 @@ struct amdgpu_gpu_info {
 	uint32_t vram_type;
 	/* video memory bit width*/
 	uint32_t vram_bit_width;
+	/** constant engine ram size*/
+	uint32_t ce_ram_size;
 };
 
 
diff --git a/amdgpu/amdgpu_gpu_info.c b/amdgpu/amdgpu_gpu_info.c
index 18cff4c..793062b 100644
--- a/amdgpu/amdgpu_gpu_info.c
+++ b/amdgpu/amdgpu_gpu_info.c
@@ -160,6 +160,7 @@ int amdgpu_query_gpu_info_init(amdgpu_device_handle dev)
 		dev->dev_info.num_shader_arrays_per_engine;
 	dev->info.vram_type = dev->dev_info.vram_type;
 	dev->info.vram_bit_width = dev->dev_info.vram_bit_width;
+	dev->info.ce_ram_size = dev->dev_info.ce_ram_size;
 
 	for (i = 0; i < (int)dev->info.num_shader_engines; i++) {
 		unsigned instance = (i << AMDGPU_INFO_MMR_SE_INDEX_SHIFT) |
diff --git a/include/drm/amdgpu_drm.h b/include/drm/amdgpu_drm.h
index 772f803..a18ad8f 100644
--- a/include/drm/amdgpu_drm.h
+++ b/include/drm/amdgpu_drm.h
@@ -586,6 +586,8 @@ struct drm_amdgpu_info_device {
 	uint32_t vram_type;
 	/** video memory bit width*/
 	uint32_t vram_bit_width;
+	/** constant engine ram size*/
+	uint32_t ce_ram_size;
 };
 
 struct drm_amdgpu_info_hw_ip {
-- 
1.9.1

