From ad74f7d4759390ebd7f79d4d80547efed5e79bb6 Mon Sep 17 00:00:00 2001
From: David Rokhvarg <David.Rokhvarg@amd.com>
Date: Mon, 23 Nov 2015 11:40:15 -0500
Subject: [PATCH 0777/1050] drm/amd/powerplay: Disable Memory PState switch as
 temp workaround for 4k@60.

Signed-off-by: David Rokhvarg <David.Rokhvarg@amd.com>
---
 drivers/gpu/drm/amd/powerplay/hwmgr/cz_hwmgr.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/drivers/gpu/drm/amd/powerplay/hwmgr/cz_hwmgr.c b/drivers/gpu/drm/amd/powerplay/hwmgr/cz_hwmgr.c
index 13b5bef..b0b5a64 100644
--- a/drivers/gpu/drm/amd/powerplay/hwmgr/cz_hwmgr.c
+++ b/drivers/gpu/drm/amd/powerplay/hwmgr/cz_hwmgr.c
@@ -1570,6 +1570,14 @@ int cz_set_cpu_power_state(struct pp_hwmgr *hwmgr)
 						PPSMC_MSG_SetDisplaySizePowerParams,
 						data);
 
+		/* 4k@60 wa - start */
+		smum_send_msg_to_smc_with_parameter(hwmgr->smumgr,
+				PPSMC_MSG_SetMinDeepSleepSclk, 0x10D8);
+
+		smum_send_msg_to_smc_with_parameter(hwmgr->smumgr,
+				PPSMC_MSG_DisableLowMemoryPstate, 0x1);
+		/* 4k@60 wa - end */
+
 		hw_data->cc6_setting_changed = false;
 	}
 
-- 
1.9.1

