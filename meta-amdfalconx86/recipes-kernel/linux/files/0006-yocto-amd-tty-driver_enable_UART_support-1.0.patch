From 5e8be0ace8901c35e63bef54f1864566346bcec7 Mon Sep 17 00:00:00 2001
From: Ken Xue <Ken.Xue@amd.com>
Date: Thu, 6 Nov 2014 09:37:28 +0800
Subject: [PATCH 3/6] enable UART support based on driver from IP vendor.

Signed-off-by: Ken Xue <Ken.Xue@amd.com>
Signed-off-by: Sanjay Mehta <sanju.mehta@amd.com>
---
 drivers/acpi/acpi_apd.c           | 11 +++++++++--
 drivers/tty/serial/8250/8250_dw.c |  1 +
 2 files changed, 10 insertions(+), 2 deletions(-)
diff -Naur a/drivers/acpi/acpi_apd.c b/drivers/acpi/acpi_apd.c
--- a/drivers/acpi/acpi_apd.c	2015-03-25 15:43:23.040812663 +0530
+++ b/drivers/acpi/acpi_apd.c	2015-03-25 15:41:26.028810368 +0530
@@ -48,11 +48,18 @@
 	.rate = 136192000, /*(133 * 1024 * 1000)*/
 };
 
+static struct apd_device_desc amd_uart_desc = {
+        .clk_required = true,
+        .fix_rate_root_clock = true,
+        .clk_name = "uart_clk",
+        .rate = 48000000,
+};
+
 static const struct acpi_device_id acpi_apd_device_ids[] = {
 	/* Generic apd devices */
 	{ "AMD0010", (unsigned long)&amd_i2c_desc },
-	/*{ "UART0000, (unsigned long)&amur_uart_dev_desc },*/
-	/*{"AMD0030", (unsigned long)&amur_gpio_dev_desc },*/
+	{ "AMD0020", (unsigned long)&amd_uart_desc },
+	/*{"AMD0030", (unsigned long)&amd_gpio_desc },*/
 	{ }
 };
 
diff -Naur a/drivers/tty/serial/8250/8250_dw.c b/drivers/tty/serial/8250/8250_dw.c
--- a/drivers/tty/serial/8250/8250_dw.c	2015-03-25 14:39:54.696737985 +0530
+++ b/drivers/tty/serial/8250/8250_dw.c	2015-03-25 15:41:26.028810368 +0530
@@ -451,6 +451,7 @@
 	{ "INT3434", 0 },
 	{ "INT3435", 0 },
 	{ "80860F0A", 0 },
+	{ "AMD0020", 0 },
 	{ },
 };
 MODULE_DEVICE_TABLE(acpi, dw8250_acpi_match);
