From 0e45a88047ff9399ff20d22758d2e3a824f70ed8 Mon Sep 17 00:00:00 2001
From: Tony Cheng <tony.cheng@amd.com>
Date: Mon, 12 Sep 2016 15:28:09 -0400
Subject: [PATCH 1072/1722] drm/amd/dal: removed deadcode in audio

- remove GTC as GTC isn't productized

Change-Id: I0a880d46490c2775e720dd7a6e4820a162141479
Signed-off-by: Tony Cheng <tony.cheng@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/dc/audio/audio_base.c      |  7 ---
 .../amd/dal/dc/audio/dce110/hw_ctx_audio_dce110.c  | 69 ----------------------
 .../amd/dal/dc/audio/dce80/hw_ctx_audio_dce80.c    |  4 --
 drivers/gpu/drm/amd/dal/dc/audio/hw_ctx_audio.h    |  4 --
 4 files changed, 84 deletions(-)

diff --git a/drivers/gpu/drm/amd/dal/dc/audio/audio_base.c b/drivers/gpu/drm/amd/dal/dc/audio/audio_base.c
index 31c600c..c197966 100644
--- a/drivers/gpu/drm/amd/dal/dc/audio/audio_base.c
+++ b/drivers/gpu/drm/amd/dal/dc/audio/audio_base.c
@@ -371,13 +371,6 @@ void dal_audio_enable_gtc_embedding_with_group(
 		audio->hw_ctx, group_num, audio_latency);
 }
 
-/* disable GTC value embedding */
-void dal_audio_disable_gtc_embedding(
-	struct audio *audio)
-{
-	audio->hw_ctx->funcs->disable_gtc_embedding(audio->hw_ctx);
-}
-
 /* perform power up sequence (boot up, resume, recovery) */
 enum audio_result dal_audio_power_up(
 	struct audio *audio)
diff --git a/drivers/gpu/drm/amd/dal/dc/audio/dce110/hw_ctx_audio_dce110.c b/drivers/gpu/drm/amd/dal/dc/audio/dce110/hw_ctx_audio_dce110.c
index d2769c7..3e7e393 100644
--- a/drivers/gpu/drm/amd/dal/dc/audio/dce110/hw_ctx_audio_dce110.c
+++ b/drivers/gpu/drm/amd/dal/dc/audio/dce110/hw_ctx_audio_dce110.c
@@ -1661,71 +1661,6 @@ static void hw_initialize(
 	}
 }
 
-/* Assign GTC group and enable GTC value embedding */
-static void enable_gtc_embedding_with_group(
-	const struct hw_ctx_audio *hw_ctx,
-	uint32_t group_num,
-	uint32_t audio_latency)
-{
-	/*need to replace the static number with variable */
-	if (group_num <= 6) {
-		uint32_t value = read_indirect_azalia_reg(
-			hw_ctx,
-			ixAZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING);
-
-		set_reg_field_value(
-			value,
-			group_num,
-			AZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING,
-			PRESENTATION_TIME_EMBEDDING_GROUP);
-
-		set_reg_field_value(
-			value,
-			1,
-			AZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING,
-			PRESENTATION_TIME_EMBEDDING_ENABLE);
-
-		write_indirect_azalia_reg(
-			hw_ctx,
-			ixAZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING,
-			value);
-
-		/*update audio latency to LIPSYNC*/
-		set_audio_latency(hw_ctx, audio_latency);
-	} else {
-		dal_logger_write(
-			hw_ctx->ctx->logger,
-			LOG_MAJOR_HW_TRACE,
-			LOG_MINOR_COMPONENT_AUDIO,
-			"GTC group number %d is too big",
-			group_num);
-	}
-}
-
- /* Disable GTC value embedding */
-static void disable_gtc_embedding(
-	const struct hw_ctx_audio *hw_ctx)
-{
-	uint32_t value = 0;
-
-	value = read_indirect_azalia_reg(
-	hw_ctx,
-	ixAZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING);
-
-	set_reg_field_value(value, 0,
-	AZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING,
-	PRESENTATION_TIME_EMBEDDING_ENABLE);
-
-	set_reg_field_value(value, 0,
-	AZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING,
-	PRESENTATION_TIME_EMBEDDING_GROUP);
-
-	write_indirect_azalia_reg(
-		hw_ctx,
-		ixAZALIA_F0_CODEC_CONVERTER_CONTROL_GTC_EMBEDDING,
-		value);
-}
-
 /* search pixel clock value for Azalia HDMI Audio */
 static bool get_azalia_clock_info_hdmi(
 	const struct hw_ctx_audio *hw_ctx,
@@ -1807,10 +1742,6 @@ static const struct hw_ctx_audio_funcs funcs = {
 		set_unsolicited_response_payload,
 	.hw_initialize =
 		hw_initialize,
-	.enable_gtc_embedding_with_group =
-		enable_gtc_embedding_with_group,
-	.disable_gtc_embedding =
-		disable_gtc_embedding,
 	.get_azalia_clock_info_hdmi =
 		get_azalia_clock_info_hdmi,
 	.get_azalia_clock_info_dp =
diff --git a/drivers/gpu/drm/amd/dal/dc/audio/dce80/hw_ctx_audio_dce80.c b/drivers/gpu/drm/amd/dal/dc/audio/dce80/hw_ctx_audio_dce80.c
index 3b2fb52..bab744e 100644
--- a/drivers/gpu/drm/amd/dal/dc/audio/dce80/hw_ctx_audio_dce80.c
+++ b/drivers/gpu/drm/amd/dal/dc/audio/dce80/hw_ctx_audio_dce80.c
@@ -1755,10 +1755,6 @@ static const struct hw_ctx_audio_funcs funcs = {
 		set_unsolicited_response_payload,
 	.hw_initialize =
 		hw_initialize,
-	.enable_gtc_embedding_with_group =
-		enable_gtc_embedding_with_group,
-	.disable_gtc_embedding =
-		disable_gtc_embedding,
 	.get_azalia_clock_info_hdmi =
 		get_azalia_clock_info_hdmi,
 	.get_azalia_clock_info_dp =
diff --git a/drivers/gpu/drm/amd/dal/dc/audio/hw_ctx_audio.h b/drivers/gpu/drm/amd/dal/dc/audio/hw_ctx_audio.h
index 8143cd5..22f9d75 100644
--- a/drivers/gpu/drm/amd/dal/dc/audio/hw_ctx_audio.h
+++ b/drivers/gpu/drm/amd/dal/dc/audio/hw_ctx_audio.h
@@ -141,10 +141,6 @@ struct hw_ctx_audio_funcs {
 		uint32_t groupNum,
 		uint32_t audioLatency);
 
-	/* Disable GTC value embedding */
-	void (*disable_gtc_embedding)(
-		const struct hw_ctx_audio *hw_ctx);
-
 	/* Disable Azalia Clock Gating Feature */
 	void (*disable_az_clock_gating)(
 		const struct hw_ctx_audio *hw_ctx);
-- 
2.7.4

