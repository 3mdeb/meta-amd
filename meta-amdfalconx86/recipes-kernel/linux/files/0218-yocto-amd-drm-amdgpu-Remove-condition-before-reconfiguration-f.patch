From 0ebf7f22eb7c0de3e459be16df34f08e4fe69519 Mon Sep 17 00:00:00 2001
From: Clark Zheng <clark.zheng@amd.com>
Date: Fri, 3 Jul 2015 16:52:10 +0800
Subject: [PATCH 335/401] drm/amdgpu: Remove condition before reconfiguration
 front end
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Reviewed-by: Michel DÃ¤nzer <michel.daenzer@amd.com>
Signed-off-by: Clark Zheng <clark.zheng@amd.com>
Signed-off-by: Sanjay R Mehta <sanju.mehta@amd.com>
---
 drivers/gpu/drm/amd/amdgpu/amdgpu_dm_types.c | 22 +++++++++-------------
 1 file changed, 9 insertions(+), 13 deletions(-)

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_dm_types.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_dm_types.c
index d4b5093..a75a6bc 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_dm_types.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_dm_types.c
@@ -932,19 +932,15 @@ int amdgpu_dm_set_config(struct drm_mode_set *set)
 		/* program plane config */
 		pl_config.display_index = acrtc->crtc_id;
 
-		/*we won't handle the wrong case: FB size < crtc->mode(viewport size) */
-		if (set->fb->height >= set->crtc->mode.vdisplay &&
-				set->fb->width >= set->crtc->mode.hdisplay) {
-
-			/*Blank display before programming surface */
-			dal_set_blanking(adev->dm.dal, acrtc->crtc_id, true);
-			fill_plane_attributes(adev, &pl_config, set->crtc);
-			dal_setup_plane_configurations(adev->dm.dal, 1, &pl_config);
-			/* program the surface addr and flip control*/
-			addr_flip_info.display_index = acrtc->crtc_id;
-			amdgpu_dm_fill_surface_address(set->crtc, &addr_flip_info, afb, save_set.fb);
-			dal_set_blanking(adev->dm.dal, acrtc->crtc_id, false);
-		}
+		/* Blank display before programming surface */
+		dal_set_blanking(adev->dm.dal, acrtc->crtc_id, true);
+		fill_plane_attributes(adev, &pl_config, set->crtc);
+		dal_setup_plane_configurations(adev->dm.dal, 1, &pl_config);
+		/* Program the surface addr and flip control */
+		addr_flip_info.display_index = acrtc->crtc_id;
+		amdgpu_dm_fill_surface_address(set->crtc, &addr_flip_info,
+					       afb, save_set.fb);
+		dal_set_blanking(adev->dm.dal, acrtc->crtc_id, false);
 	}
 	DRM_DEBUG_KMS("=== Finished dm_set_config ===\n");
 
-- 
1.9.1

