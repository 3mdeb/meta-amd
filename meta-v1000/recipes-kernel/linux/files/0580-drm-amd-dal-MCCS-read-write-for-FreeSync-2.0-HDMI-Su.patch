From d79f5cdcd0b797be3b45d4ce92a1ef6248499661 Mon Sep 17 00:00:00 2001
From: Amy Zhang <Amy.Zhang@amd.com>
Date: Wed, 15 Jun 2016 12:01:33 -0400
Subject: [PATCH 0580/1722] drm/amd/dal: MCCS read/write for FreeSync 2.0 HDMI
 Support

Change-Id: I8492cb8629ad265c4778c6f566cd6ace21e3b60d
Signed-off-by: Amy Zhang <Amy.Zhang@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/dc/dc.h                     | 1 +
 drivers/gpu/drm/amd/dal/dc/dce100/dce100_resource.c | 2 +-
 drivers/gpu/drm/amd/dal/dc/dce110/dce110_resource.c | 1 +
 drivers/gpu/drm/amd/dal/dc/dce112/dce112_resource.c | 1 +
 drivers/gpu/drm/amd/dal/dc/dce80/dce80_resource.c   | 1 +
 5 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/amd/dal/dc/dc.h b/drivers/gpu/drm/amd/dal/dc/dc.h
index f86754d..792a1b1 100644
--- a/drivers/gpu/drm/amd/dal/dc/dc.h
+++ b/drivers/gpu/drm/amd/dal/dc/dc.h
@@ -45,6 +45,7 @@ struct dc_caps {
 	uint32_t max_audios;
 	uint32_t max_underlays;
 	uint32_t max_downscale_ratio;
+	uint32_t i2c_speed_in_khz;
 };
 
 struct dc;
diff --git a/drivers/gpu/drm/amd/dal/dc/dce100/dce100_resource.c b/drivers/gpu/drm/amd/dal/dc/dce100/dce100_resource.c
index 8a984b2..8ddf452 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce100/dce100_resource.c
+++ b/drivers/gpu/drm/amd/dal/dc/dce100/dce100_resource.c
@@ -819,7 +819,7 @@ bool dce100_construct_resource_pool(
 	pool->stream_enc_count = dal_adapter_service_get_stream_engines_num(as);
 	pool->scaler_filter = dal_scaler_filter_create(ctx);
         dc->public.caps.max_downscale_ratio = 200;
-
+        dc->public.caps.i2c_speed_in_khz = 40;
 	
 	if (pool->scaler_filter == NULL) {
 		BREAK_TO_DEBUGGER();
diff --git a/drivers/gpu/drm/amd/dal/dc/dce110/dce110_resource.c b/drivers/gpu/drm/amd/dal/dc/dce110/dce110_resource.c
index e579589..cb9fe06 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce110/dce110_resource.c
+++ b/drivers/gpu/drm/amd/dal/dc/dce110/dce110_resource.c
@@ -1058,6 +1058,7 @@ bool dce110_construct_resource_pool(
 	pool->stream_enc_count = 3;
  
         dc->public.caps.max_downscale_ratio = 150;
+        dc->public.caps.i2c_speed_in_khz = 100;
 
 	/*************************************************
 	 *  Create resources                             *
diff --git a/drivers/gpu/drm/amd/dal/dc/dce112/dce112_resource.c b/drivers/gpu/drm/amd/dal/dc/dce112/dce112_resource.c
index e90c4e6..c5e3ce0 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce112/dce112_resource.c
+++ b/drivers/gpu/drm/amd/dal/dc/dce112/dce112_resource.c
@@ -1062,6 +1062,7 @@ bool dce112_construct_resource_pool(
 		dal_adapter_service_get_func_controllers_num(adapter_serv);
 	pool->stream_enc_count = dal_adapter_service_get_stream_engines_num(adapter_serv);
         dc->public.caps.max_downscale_ratio = 200;
+        dc->public.caps.i2c_speed_in_khz = 100;
 
 	/*************************************************
 	 *  Create resources                             *
diff --git a/drivers/gpu/drm/amd/dal/dc/dce80/dce80_resource.c b/drivers/gpu/drm/amd/dal/dc/dce80/dce80_resource.c
index 5e7dd9a..6aadbe3 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce80/dce80_resource.c
+++ b/drivers/gpu/drm/amd/dal/dc/dce80/dce80_resource.c
@@ -708,6 +708,7 @@ bool dce80_construct_resource_pool(
 	pool->pipe_count = dal_adapter_service_get_func_controllers_num(as);
 	pool->stream_enc_count = dal_adapter_service_get_stream_engines_num(as);
         dc->public.caps.max_downscale_ratio = 200;
+        dc->public.caps.i2c_speed_in_khz = 40;
 
 	/*************************************************
 	 *  Create resources                             *
-- 
2.7.4

