From d23f6b6b51c9b1869531f0bf31bca5447c6f84fa Mon Sep 17 00:00:00 2001
From: Mykola Lysenko <mykola.lysenko@amd.com>
Date: Fri, 6 Feb 2015 09:17:09 -0500
Subject: [PATCH 369/401] amd/dal: removed unused functions in blank/unblank
 sequence

Reviewed-By: Aric Cyr <Aric.Cyr@amd.com>
Signed-off-by: Mykola Lysenko <mykola.lysenko@amd.com>
Signed-off-by: Sanjay R Mehta <sanju.mehta@amd.com>
---
 drivers/gpu/drm/amd/dal/controller/controller.c              | 12 ------------
 .../drm/amd/dal/controller/dce110/timing_generator_dce110.c  | 11 +++++++----
 .../amd/dal/controller/dce110/timing_generator_v_dce110.c    |  1 -
 drivers/gpu/drm/amd/dal/controller/timing_generator.h        |  2 --
 drivers/gpu/drm/amd/dal/hw_sequencer/hw_sequencer.c          |  4 ----
 drivers/gpu/drm/amd/dal/include/controller_interface.h       |  2 --
 drivers/gpu/drm/amd/dal/topology/topology.c                  |  4 ----
 7 files changed, 7 insertions(+), 29 deletions(-)

diff --git a/drivers/gpu/drm/amd/dal/controller/controller.c b/drivers/gpu/drm/amd/dal/controller/controller.c
index 993454c..41b9cc2 100644
--- a/drivers/gpu/drm/amd/dal/controller/controller.c
+++ b/drivers/gpu/drm/amd/dal/controller/controller.c
@@ -419,18 +419,6 @@ void dal_controller_set_fe_clock(struct controller *crtc, bool enable)
 		crtc->pc->funcs->enable_fe_clock(crtc->pc, enable);
 }
 
-bool dal_controller_disable_memory_requests(struct controller *crtc)
-{
-	return true;
-	/* TODO to be implemented */
-}
-
-bool dal_controller_enable_memory_requests(struct controller *crtc)
-{
-	return true;
-	/* TODO to be implemented */
-}
-
 void dal_controller_enable_display_pipe_clock_gating(
 	struct controller *crtc,
 	bool enable)
diff --git a/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_dce110.c b/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_dce110.c
index 22b2818..161cfa6 100644
--- a/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_dce110.c
+++ b/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_dce110.c
@@ -207,7 +207,10 @@ static bool blank_crtc(
 	struct bp_blank_crtc_parameters params;
 	struct crtc_black_color black_color;
 
-	tg->funcs->color_space_to_black_color(color_space, &black_color);
+	dal_timing_generator_color_space_to_black_color(
+		color_space,
+		&black_color);
+
 	dal_memset(&params, 0, sizeof(struct bp_blank_crtc_parameters));
 	params.controller_id = tg->controller_id;
 	params.black_color_rcr = black_color.black_color_r_cr;
@@ -262,7 +265,9 @@ static bool unblank_crtc(
 	struct bp_blank_crtc_parameters bp_params;
 	struct crtc_black_color value;
 
-	tg->funcs->color_space_to_black_color(color_space, &value);
+	dal_timing_generator_color_space_to_black_color(
+		color_space,
+		&value);
 
 	dal_memset(&bp_params, 0,
 		sizeof(struct bp_blank_crtc_parameters));
@@ -1087,8 +1092,6 @@ static const struct timing_generator_funcs timing_generator_dce110_funcs = {
 		.unblank_crtc = unblank_crtc,
 		.validate_timing = dal_timing_generator_validate_timing,
 		.destroy = destroy,
-		.color_space_to_black_color =
-				dal_timing_generator_color_space_to_black_color,
 		.wait_for_vactive =
 				dal_timing_generator_wait_for_vactive,
 		.force_triggered_reset_now =
diff --git a/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_v_dce110.c b/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_v_dce110.c
index 2ceceda..5f6dee7 100644
--- a/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_v_dce110.c
+++ b/drivers/gpu/drm/amd/dal/controller/dce110/timing_generator_v_dce110.c
@@ -454,7 +454,6 @@ static const struct timing_generator_funcs timing_generator_dce110_funcs = {
 		.unblank_crtc = NULL,
 		.validate_timing = NULL,
 		.destroy = destroy,
-		.color_space_to_black_color = NULL,
 		.wait_for_vactive = NULL,
 		.force_triggered_reset_now = NULL,
 		.wait_for_vblank = NULL,
diff --git a/drivers/gpu/drm/amd/dal/controller/timing_generator.h b/drivers/gpu/drm/amd/dal/controller/timing_generator.h
index 5f43edb..66a2d71 100644
--- a/drivers/gpu/drm/amd/dal/controller/timing_generator.h
+++ b/drivers/gpu/drm/amd/dal/controller/timing_generator.h
@@ -180,8 +180,6 @@ struct timing_generator_funcs {
 		const struct trigger_params *trigger_params);
 	void (*wait_for_vactive)(struct timing_generator *tg);
 	void (*wait_for_vblank)(struct timing_generator *tg);
-	void (*color_space_to_black_color)(enum color_space colorspace,
-		struct crtc_black_color *black_color);
 	uint32_t (*get_crtc_scanoutpos)(
 		struct timing_generator *tg,
 		int32_t *vpos,
diff --git a/drivers/gpu/drm/amd/dal/hw_sequencer/hw_sequencer.c b/drivers/gpu/drm/amd/dal/hw_sequencer/hw_sequencer.c
index 29e15bc..024052a 100644
--- a/drivers/gpu/drm/amd/dal/hw_sequencer/hw_sequencer.c
+++ b/drivers/gpu/drm/amd/dal/hw_sequencer/hw_sequencer.c
@@ -1414,8 +1414,6 @@ void dal_hw_sequencer_enable_memory_requests(struct hw_sequencer *hws,
 		/* no need to enable memory requests if source is not blanked */
 		return;
 
-	dal_controller_enable_memory_requests(controller);
-
 	dal_line_buffer_reset_on_vblank(
 			dal_controller_get_line_buffer(controller),
 			dal_controller_get_id(controller));
@@ -1445,8 +1443,6 @@ void dal_hw_sequencer_disable_memory_requests(
 
 	dal_controller_blank_crtc(controller, color_space);
 
-	dal_controller_disable_memory_requests(controller);
-
 	dal_display_path_set_source_blanked(
 			hw_path_mode->display_path,
 			DISPLAY_TRI_STATE_TRUE);
diff --git a/drivers/gpu/drm/amd/dal/include/controller_interface.h b/drivers/gpu/drm/amd/dal/include/controller_interface.h
index 90f0fc2..8cc06fa 100644
--- a/drivers/gpu/drm/amd/dal/include/controller_interface.h
+++ b/drivers/gpu/drm/amd/dal/include/controller_interface.h
@@ -168,8 +168,6 @@ uint32_t dal_controller_get_vblank_counter(struct controller *crtc);
 /* Set */
 bool dal_controller_enable_timing_generator(struct controller *crtc);
 bool dal_controller_disable_timing_generator(struct controller *crtc);
-bool dal_controller_enable_memory_requests(struct controller *crtc);
-bool dal_controller_disable_memory_requests(struct controller *crtc);
 bool dal_controller_program_timing_generator(
 	struct controller *crtc,
 	struct hw_crtc_timing *timing);
diff --git a/drivers/gpu/drm/amd/dal/topology/topology.c b/drivers/gpu/drm/amd/dal/topology/topology.c
index fa74b76..0ebce7a 100644
--- a/drivers/gpu/drm/amd/dal/topology/topology.c
+++ b/drivers/gpu/drm/amd/dal/topology/topology.c
@@ -3982,11 +3982,7 @@ void dal_tm_disable_all_dcp_pipes(struct topology_mgr *tm)
 		 * command table. */
 		dal_controller_blank_crtc(controller,
 				COLOR_SPACE_SRGB_FULL_RANGE);
-
-		/* disable memory requests on controller */
-		dal_controller_disable_memory_requests(controller);
 	}
-
 }
 
 /* Callback interface - a way for tm_detection_mgr to notify
-- 
1.9.1

