From 8649ecc02c75f70bcc7bcc38fa2bd55da43c86f3 Mon Sep 17 00:00:00 2001
From: Monk Liu <monk.liu@amd.com>
Date: Mon, 7 Aug 2017 22:25:35 +0800
Subject: [PATCH 40/46] drm: fix missing mutex unlock before return
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Change-Id: I377dde976648d53bc9a3a2d5ba294c284910b109
Signed-off-by: Monk Liu <monk.liu@amd.com>
Reviewed-by: Christian KÃ¶nig <christian.koenig@amd.com>
Acked-by: Qiang Yu <Qiang.Yu@amd.com>
---
 amdgpu/amdgpu_bo.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/amdgpu/amdgpu_bo.c b/amdgpu/amdgpu_bo.c
index 9534c40..76126a2 100644
--- a/amdgpu/amdgpu_bo.c
+++ b/amdgpu/amdgpu_bo.c
@@ -304,6 +304,7 @@ int amdgpu_bo_import(amdgpu_device_handle dev,
 		/* Get a KMS handle. */
 		r = drmPrimeFDToHandle(dev->fd, shared_handle, &handle);
 		if (r) {
+			pthread_mutex_unlock(&dev->bo_table_mutex);
 			return r;
 		}
 
-- 
2.7.4

