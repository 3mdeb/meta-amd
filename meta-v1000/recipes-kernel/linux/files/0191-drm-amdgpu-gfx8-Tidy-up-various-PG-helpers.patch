From 51414bb06ec7b705a80ec9576688f7a218b79057 Mon Sep 17 00:00:00 2001
From: Tom St Denis <tom.stdenis@amd.com>
Date: Fri, 3 Jun 2016 12:52:03 -0400
Subject: [PATCH 0191/1722] drm/amdgpu/gfx8: Tidy up various PG helpers

Signed-off-by: Tom St Denis <tom.stdenis@amd.com>
Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/amdgpu/gfx_v8_0.c | 34 ++++++++++++----------------------
 1 file changed, 12 insertions(+), 22 deletions(-)

diff --git a/drivers/gpu/drm/amd/amdgpu/gfx_v8_0.c b/drivers/gpu/drm/amd/amdgpu/gfx_v8_0.c
index d1a0a47..7d532a5 100644
--- a/drivers/gpu/drm/amd/amdgpu/gfx_v8_0.c
+++ b/drivers/gpu/drm/amd/amdgpu/gfx_v8_0.c
@@ -5301,20 +5301,15 @@ static void gfx_v8_0_enable_gfx_static_mg_power_gating(struct amdgpu_device *ade
                                              enable ?
                                              AMD_PG_STATE_GATE : AMD_PG_STATE_UNGATE);
  
-	 if (enable) {
-		 /* Enable static MGPG */
-		 temp = data = RREG32(mmRLC_PG_CNTL);
+         temp = data = RREG32(mmRLC_PG_CNTL);
+         /* Enable static MGPG */
+         if (enable)
 		 data |= RLC_PG_CNTL__STATIC_PER_CU_PG_ENABLE_MASK;
- 
-		 if (temp != data)
-			 WREG32(mmRLC_PG_CNTL, data);
-	 } else {
-		 temp = data = RREG32(mmRLC_PG_CNTL);
+         else
 		 data &= ~RLC_PG_CNTL__STATIC_PER_CU_PG_ENABLE_MASK;
  
-		 if (temp != data)
-			 WREG32(mmRLC_PG_CNTL, data);
-	 }
+	 if (temp != data)
+		 WREG32(mmRLC_PG_CNTL, data);
 }
 
 static void gfx_v8_0_enable_gfx_dynamic_mg_power_gating(struct amdgpu_device *adev,
@@ -5322,20 +5317,15 @@ static void gfx_v8_0_enable_gfx_dynamic_mg_power_gating(struct amdgpu_device *ad
 {
 	 uint32_t data, temp;
  
-	 if (enable) {
-		 /* Enable dynamic MGPG */
-		 temp = data = RREG32(mmRLC_PG_CNTL);
+        temp = data = RREG32(mmRLC_PG_CNTL);
+        /* Enable dynamic MGPG */
+        if (enable)
 		 data |= RLC_PG_CNTL__DYN_PER_CU_PG_ENABLE_MASK;
- 
-		 if (temp != data)
-			 WREG32(mmRLC_PG_CNTL, data);
-	 } else {
-		 temp = data = RREG32(mmRLC_PG_CNTL);
+        else 
 		 data &= ~RLC_PG_CNTL__DYN_PER_CU_PG_ENABLE_MASK;
  
-		 if (temp != data)
-			 WREG32(mmRLC_PG_CNTL, data);
-	 }
+        if (temp != data)
+                WREG32(mmRLC_PG_CNTL, data);
 }
 
 static void cz_enable_gfx_cg_power_gating(struct amdgpu_device *adev,
-- 
2.7.4

