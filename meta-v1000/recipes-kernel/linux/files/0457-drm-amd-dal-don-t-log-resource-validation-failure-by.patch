From 2cfe7b1e6313cd1ad82a7b82e34b8b002d228e66 Mon Sep 17 00:00:00 2001
From: Eric Yang <eric.yang2@amd.com>
Date: Thu, 28 Apr 2016 18:24:42 -0400
Subject: [PATCH 0457/1722] drm/amd/dal: don't log resource validation failure
 by default

Signed-off-by: Eric Yang <eric.yang2@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/dc/basics/logger.c | 4 +++-
 drivers/gpu/drm/amd/dal/dc/core/dc.c       | 4 ++--
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/drm/amd/dal/dc/basics/logger.c b/drivers/gpu/drm/amd/dal/dc/basics/logger.c
index 93d4185..298354f 100644
--- a/drivers/gpu/drm/amd/dal/dc/basics/logger.c
+++ b/drivers/gpu/drm/amd/dal/dc/basics/logger.c
@@ -247,10 +247,12 @@ struct log_major_mask_info {
 
 #define LG_BWM_MSK (1 << LOG_MINOR_BWM_MODE_VALIDATION)
 
+#define LG_WARN_MSK ~(1 << LOG_MINOR_COMPONENT_TOPOLOGY_MANAGER)
+
 static const struct log_major_mask_info log_major_mask_info_tbl[] = {
 	/* LogMajor                  major name       default     MinorTble                    tblElementCnt */
 	{{LOG_MAJOR_ERROR,           "Error"       }, LG_ALL_MSK, component_minor_info_tbl,    NUM_ELEMENTS(component_minor_info_tbl)},
-	{{LOG_MAJOR_WARNING,         "Warning"     }, LG_ALL_MSK, component_minor_info_tbl,    NUM_ELEMENTS(component_minor_info_tbl)},
+	{{LOG_MAJOR_WARNING,         "Warning"     }, LG_WARN_MSK, component_minor_info_tbl,    NUM_ELEMENTS(component_minor_info_tbl)},
 	{{LOG_MAJOR_INTERFACE_TRACE, "IfTrace"     }, LG_ALL_MSK, component_minor_info_tbl,    NUM_ELEMENTS(component_minor_info_tbl)},
 	{{LOG_MAJOR_HW_TRACE,        "HwTrace"     }, (LG_ALL_MSK &
 			~((1 << LOG_MINOR_HW_TRACE_LINK_TRAINING) |
diff --git a/drivers/gpu/drm/amd/dal/dc/core/dc.c b/drivers/gpu/drm/amd/dal/dc/core/dc.c
index 253ac6c..0123659 100644
--- a/drivers/gpu/drm/amd/dal/dc/core/dc.c
+++ b/drivers/gpu/drm/amd/dal/dc/core/dc.c
@@ -466,8 +466,8 @@ bool dc_validate_resources(
 context_alloc_fail:
 	if (result != DC_OK) {
 		dal_logger_write(core_dc->ctx->logger,
-				LOG_MAJOR_INTERFACE_TRACE,
-				LOG_MINOR_COMPONENT_DC,
+				LOG_MAJOR_WARNING,
+				LOG_MINOR_COMPONENT_TOPOLOGY_MANAGER,
 				"%s:resource validation failed, dc_status:%d\n",
 				__func__,
 				result);
-- 
2.7.4

