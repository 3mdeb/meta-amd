From 7abf10bcb9c55c5130b25ae60db254389f176430 Mon Sep 17 00:00:00 2001
From: Jammy Zhou <Jammy.Zhou@amd.com>
Date: Tue, 16 Jun 2015 22:42:43 +0800
Subject: [PATCH 43/67] amdgpu: do NULL check for bo handle in
 amdgpu_bo_query_info
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Jammy Zhou <Jammy.Zhou@amd.com>
Reviewed-by: Christian KÃ¶nig <christian.koenig@amd.com>
Signed-off-by: Arindam Nath <arindam.nath@amd.com>
---
 amdgpu/amdgpu_bo.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/amdgpu/amdgpu_bo.c b/amdgpu/amdgpu_bo.c
index 770a72b..07df1c5 100644
--- a/amdgpu/amdgpu_bo.c
+++ b/amdgpu/amdgpu_bo.c
@@ -225,6 +225,10 @@ int amdgpu_bo_query_info(amdgpu_bo_handle bo,
 	struct drm_amdgpu_gem_op gem_op = {};
 	int r;
 
+	/* Validate the BO passed in */
+	if (!bo->handle)
+		return -EINVAL;
+
 	/* Query metadata. */
 	metadata.handle = bo->handle;
 	metadata.op = AMDGPU_GEM_METADATA_OP_GET_METADATA;
-- 
1.9.1

