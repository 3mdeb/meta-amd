From 558d1138738172298db112ec2d8f3e425431f454 Mon Sep 17 00:00:00 2001
From: Tony Cheng <tony.cheng@amd.com>
Date: Sat, 15 Oct 2016 21:57:13 -0400
Subject: [PATCH 1334/1722] drm/amd/dal: remove dead code in
 hw_ctx_adapter_service

Change-Id: I33c926c6c439c5824178b626a289a2737be57df0
Signed-off-by: Tony Cheng <tony.cheng@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
---
 .../adapter/dce110/hw_ctx_adapter_service_dce110.c | 12 ----
 .../adapter/dce112/hw_ctx_adapter_service_dce112.c | 11 ----
 .../adapter/dce80/hw_ctx_adapter_service_dce80.c   | 73 ----------------------
 .../diagnostics/hw_ctx_adapter_service_diag.c      | 32 ----------
 .../amd/dal/dc/adapter/hw_ctx_adapter_service.c    | 35 -----------
 .../amd/dal/dc/adapter/hw_ctx_adapter_service.h    | 16 -----
 6 files changed, 179 deletions(-)

diff --git a/drivers/gpu/drm/amd/dal/dc/adapter/dce110/hw_ctx_adapter_service_dce110.c b/drivers/gpu/drm/amd/dal/dc/adapter/dce110/hw_ctx_adapter_service_dce110.c
index 73eb816..1080953 100644
--- a/drivers/gpu/drm/amd/dal/dc/adapter/dce110/hw_ctx_adapter_service_dce110.c
+++ b/drivers/gpu/drm/amd/dal/dc/adapter/dce110/hw_ctx_adapter_service_dce110.c
@@ -246,22 +246,10 @@ static bool power_up(
 	return true;
 }
 
-static void update_audio_connectivity(
-	struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t number_of_audio_capable_display_path,
-	uint32_t number_of_controllers)
-{
-	/* this one should be empty on DCE110 */
-}
-
 static const struct hw_ctx_adapter_service_funcs funcs = {
 	.destroy = destroy,
 	.power_up = power_up,
-	.enum_fake_path_resource = NULL,
-	.enum_stereo_sync_object = NULL,
-	.enum_sync_output_object = NULL,
 	.enum_audio_object = enum_audio_object,
-	.update_audio_connectivity = update_audio_connectivity
 };
 
 static bool construct(
diff --git a/drivers/gpu/drm/amd/dal/dc/adapter/dce112/hw_ctx_adapter_service_dce112.c b/drivers/gpu/drm/amd/dal/dc/adapter/dce112/hw_ctx_adapter_service_dce112.c
index f438998..029e3ae 100644
--- a/drivers/gpu/drm/amd/dal/dc/adapter/dce112/hw_ctx_adapter_service_dce112.c
+++ b/drivers/gpu/drm/amd/dal/dc/adapter/dce112/hw_ctx_adapter_service_dce112.c
@@ -246,22 +246,11 @@ static bool power_up(
 	return true;
 }
 
-static void update_audio_connectivity(
-	struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t number_of_audio_capable_display_path,
-	uint32_t number_of_controllers)
-{
-	/* this one should be empty on DCE112 */
-}
 
 static const struct hw_ctx_adapter_service_funcs funcs = {
 	.destroy = destroy,
 	.power_up = power_up,
-	.enum_fake_path_resource = NULL,
-	.enum_stereo_sync_object = NULL,
-	.enum_sync_output_object = NULL,
 	.enum_audio_object = enum_audio_object,
-	.update_audio_connectivity = update_audio_connectivity
 };
 
 static bool construct(
diff --git a/drivers/gpu/drm/amd/dal/dc/adapter/dce80/hw_ctx_adapter_service_dce80.c b/drivers/gpu/drm/amd/dal/dc/adapter/dce80/hw_ctx_adapter_service_dce80.c
index 95d0d00..5f005b0 100644
--- a/drivers/gpu/drm/amd/dal/dc/adapter/dce80/hw_ctx_adapter_service_dce80.c
+++ b/drivers/gpu/drm/amd/dal/dc/adapter/dce80/hw_ctx_adapter_service_dce80.c
@@ -189,38 +189,6 @@ static bool power_up(
 	return true;
 }
 
-static struct graphics_object_id enum_fake_path_resource(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	if (index == 0)
-		return dal_graphics_object_id_init(
-			CONNECTOR_ID_VGA,
-			ENUM_ID_1,
-			OBJECT_TYPE_CONNECTOR);
-	else if (index == 1)
-		return dal_graphics_object_id_init(
-			ENCODER_ID_INTERNAL_KLDSCP_DAC1,
-			ENUM_ID_1,
-			OBJECT_TYPE_ENCODER);
-	else
-		return invalid_go;
-}
-
-static struct graphics_object_id enum_stereo_sync_object(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
-static struct graphics_object_id enum_sync_output_object(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
 static struct graphics_object_id enum_audio_object(
 	const struct hw_ctx_adapter_service *hw_ctx,
 	uint32_t index)
@@ -237,51 +205,10 @@ static struct graphics_object_id enum_audio_object(
 			OBJECT_TYPE_AUDIO);
 }
 
-static void update_audio_connectivity(
-	struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t number_of_audio_capable_display_path,
-	uint32_t number_of_controllers)
-{
-	uint32_t number_of_connected_audio_endpoints =
-		FROM_HW_CTX(hw_ctx)->number_of_connected_audio_endpoints;
-
-	uint32_t co_func_audio_endpoint = number_of_connected_audio_endpoints;
-	struct dc_context *ctx = hw_ctx->ctx;
-
-	if (co_func_audio_endpoint > number_of_audio_capable_display_path)
-		co_func_audio_endpoint = number_of_audio_capable_display_path;
-
-	if (co_func_audio_endpoint > number_of_controllers)
-		co_func_audio_endpoint = number_of_controllers;
-
-	if (co_func_audio_endpoint < number_of_connected_audio_endpoints) {
-		const uint32_t addr = mmCC_RCU_DC_AUDIO_PORT_CONNECTIVITY;
-
-		uint32_t value;
-
-		value = dm_read_reg(ctx, addr);
-
-		set_reg_field_value(value,
-				7 - co_func_audio_endpoint,
-				CC_RCU_DC_AUDIO_PORT_CONNECTIVITY,
-				PORT_CONNECTIVITY);
-		set_reg_field_value(value,
-				1,
-				CC_RCU_DC_AUDIO_PORT_CONNECTIVITY,
-				PORT_CONNECTIVITY_OVERRIDE_ENABLE);
-
-		dm_write_reg(ctx, addr, value);
-	}
-}
-
 static const struct hw_ctx_adapter_service_funcs funcs = {
 	destroy,
 	power_up,
-	enum_fake_path_resource,
-	enum_stereo_sync_object,
-	enum_sync_output_object,
 	enum_audio_object,
-	update_audio_connectivity
 };
 
 static bool construct(
diff --git a/drivers/gpu/drm/amd/dal/dc/adapter/diagnostics/hw_ctx_adapter_service_diag.c b/drivers/gpu/drm/amd/dal/dc/adapter/diagnostics/hw_ctx_adapter_service_diag.c
index 363564f..a64b0ef 100644
--- a/drivers/gpu/drm/amd/dal/dc/adapter/diagnostics/hw_ctx_adapter_service_diag.c
+++ b/drivers/gpu/drm/amd/dal/dc/adapter/diagnostics/hw_ctx_adapter_service_diag.c
@@ -49,27 +49,6 @@ static bool power_up(
 	return true;
 }
 
-static struct graphics_object_id enum_fake_path_resource(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
-static struct graphics_object_id enum_stereo_sync_object(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
-static struct graphics_object_id enum_sync_output_object(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
 static struct graphics_object_id enum_audio_object(
 	const struct hw_ctx_adapter_service *hw_ctx,
 	uint32_t index)
@@ -77,21 +56,10 @@ static struct graphics_object_id enum_audio_object(
 	return invalid_go;
 }
 
-static void update_audio_connectivity(
-	struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t number_of_audio_capable_display_path,
-	uint32_t number_of_controllers)
-{
-}
-
 static const struct hw_ctx_adapter_service_funcs funcs = {
 	destroy,
 	power_up,
-	enum_fake_path_resource,
-	enum_stereo_sync_object,
-	enum_sync_output_object,
 	enum_audio_object,
-	update_audio_connectivity
 };
 
 static bool construct(
diff --git a/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.c b/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.c
index 12eabe0..b569fb2 100644
--- a/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.c
+++ b/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.c
@@ -50,27 +50,6 @@ static bool power_up(
 	return false;
 }
 
-static struct graphics_object_id enum_fake_path_resource(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
-static struct graphics_object_id enum_stereo_sync_object(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
-static struct graphics_object_id enum_sync_output_object(
-	const struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t index)
-{
-	return invalid_go;
-}
-
 static struct graphics_object_id enum_audio_object(
 	const struct hw_ctx_adapter_service *hw_ctx,
 	uint32_t index)
@@ -88,24 +67,10 @@ static struct graphics_object_id enum_audio_object(
 			OBJECT_TYPE_AUDIO);
 }
 
-static void update_audio_connectivity(
-	struct hw_ctx_adapter_service *hw_ctx,
-	uint32_t number_of_audio_capable_display_path,
-	uint32_t number_of_controllers)
-{
-	/* Attention!
-	 * You must override impl method in derived class */
-	BREAK_TO_DEBUGGER();
-}
-
 static const struct hw_ctx_adapter_service_funcs funcs = {
 	destroy,
 	power_up,
-	enum_fake_path_resource,
-	enum_stereo_sync_object,
-	enum_sync_output_object,
 	enum_audio_object,
-	update_audio_connectivity
 };
 
 bool dal_adapter_service_construct_hw_ctx(
diff --git a/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.h b/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.h
index f98c2d4..8cce26f 100644
--- a/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.h
+++ b/drivers/gpu/drm/amd/dal/dc/adapter/hw_ctx_adapter_service.h
@@ -42,26 +42,10 @@ struct hw_ctx_adapter_service_funcs {
 	 * and caches relevant data from HW registers */
 	bool (*power_up)(
 		struct hw_ctx_adapter_service *hw_ctx);
-	/* Enumerate fake path resources */
-	struct graphics_object_id (*enum_fake_path_resource)(
-		const struct hw_ctx_adapter_service *hw_ctx,
-		uint32_t index);
-	/* Enumerate stereo sync objects */
-	struct graphics_object_id (*enum_stereo_sync_object)(
-		const struct hw_ctx_adapter_service *hw_ctx,
-		uint32_t index);
-	/* Enumerate (H/V) sync output objects */
-	struct graphics_object_id (*enum_sync_output_object)(
-		const struct hw_ctx_adapter_service *hw_ctx,
-		uint32_t index);
 	/* Enumerate audio objects */
 	struct graphics_object_id (*enum_audio_object)(
 		const struct hw_ctx_adapter_service *hw_ctx,
 		uint32_t index);
-	void (*update_audio_connectivity)(
-		struct hw_ctx_adapter_service *hw_ctx,
-		uint32_t number_of_audio_capable_display_path,
-		uint32_t number_of_controllers);
 };
 
 struct hw_ctx_adapter_service {
-- 
2.7.4

