From c4d2fd5c63204ff693bd90084c8c69d5113cce44 Mon Sep 17 00:00:00 2001
From: Roman Li <Roman.Li@amd.com>
Date: Thu, 4 Aug 2016 09:39:20 -0400
Subject: [PATCH 0718/1722] drm/amd/dal: fix glitchless timing sync for dce80

Add is_blanked to dce80 timing generator functions

Signed-off-by: Roman Li <Roman.Li@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.c | 2 +-
 drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.h | 2 ++
 drivers/gpu/drm/amd/dal/dc/dce80/dce80_timing_generator.c   | 1 +
 3 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.c b/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.c
index fe1285b..9ee3230 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.c
+++ b/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.c
@@ -1476,7 +1476,7 @@ void dce110_tg_program_timing(struct timing_generator *tg,
 		dce110_timing_generator_program_blanking(tg, timing);
 }
 
-static bool dce110_tg_is_blanked(struct timing_generator *tg)
+bool dce110_tg_is_blanked(struct timing_generator *tg)
 {
 	struct dce110_timing_generator *tg110 = DCE110TG_FROM_TG(tg);
 	uint32_t value = dm_read_reg(tg->ctx, CRTC_REG(mmCRTC_BLANK_CONTROL));
diff --git a/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.h b/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.h
index 9bac222..850ee5a 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.h
+++ b/drivers/gpu/drm/amd/dal/dc/dce110/dce110_timing_generator.h
@@ -194,6 +194,8 @@ void dce110_tg_program_timing(struct timing_generator *tg,
 	const struct dc_crtc_timing *timing,
 	bool use_vbios);
 
+bool dce110_tg_is_blanked(struct timing_generator *tg);
+
 bool dce110_tg_set_blank(struct timing_generator *tg,
 		bool enable_blanking);
 
diff --git a/drivers/gpu/drm/amd/dal/dc/dce80/dce80_timing_generator.c b/drivers/gpu/drm/amd/dal/dc/dce80/dce80_timing_generator.c
index 9738d12..aa6ab35 100644
--- a/drivers/gpu/drm/amd/dal/dc/dce80/dce80_timing_generator.c
+++ b/drivers/gpu/drm/amd/dal/dc/dce80/dce80_timing_generator.c
@@ -128,6 +128,7 @@ static const struct timing_generator_funcs dce80_tg_funcs = {
 		.set_early_control = dce110_timing_generator_set_early_control,
 		.wait_for_state = dce110_tg_wait_for_state,
 		.set_blank = dce110_tg_set_blank,
+		.is_blanked = dce110_tg_is_blanked,
 		.set_colors = dce110_tg_set_colors,
 		.set_overscan_blank_color =
 				dce110_timing_generator_set_overscan_color_black,
-- 
2.7.4

