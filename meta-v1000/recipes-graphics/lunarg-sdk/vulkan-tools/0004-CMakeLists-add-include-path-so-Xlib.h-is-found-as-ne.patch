From e4fe9258945ae580377be1c736ffab309a60189b Mon Sep 17 00:00:00 2001
From: Awais Belal <awais_belal@mentor.com>
Date: Wed, 31 May 2017 17:01:59 +0500
Subject: [PATCH 4/5] CMakeLists: add include path so Xlib.h is found as needed

All the targets including vk_platform.h or directly including
X11/Xlib.h require to know the directory for the installed
header. Add the directory to these so the requirements are
filled in properly.

Signed-off-by: Awais Belal <awais_belal@mentor.com>
---
 CMakeLists.txt                        | 2 ++
 layers/CMakeLists.txt                 | 1 +
 layersvt/CMakeLists.txt               | 1 +
 vktrace/vktrace_common/CMakeLists.txt | 1 +
 vktrace/vktrace_layer/CMakeLists.txt  | 1 +
 vktrace/vktrace_replay/CMakeLists.txt | 1 +
 vktrace/vktrace_trace/CMakeLists.txt  | 1 +
 7 files changed, 8 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 10c1b8150..6fc30b8c0 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -215,6 +215,8 @@ find_path(SPIRV_TOOLS_INCLUDE_DIR spirv-tools/libspirv.h HINTS "${EXTERNAL_SOURC
                                                    "${EXTERNAL_SOURCE_ROOT}/source/spirv-tools/external/include"
                                              DOC "Path to spirv-tools/libspirv.h")
 
+find_path(X11_XLIB_INCLUDE_DIR X11/Xlib.h DOC "Path to X11/Xlib.h")
+
 find_path(JSONCPP_INCLUDE_DIR json/json.h HINTS "${EXTERNAL_SOURCE_ROOT}/jsoncpp/dist"
                                                    "${EXTERNAL_SOURCE_ROOT}/JsonCpp/dist"
                                                    "${EXTERNAL_SOURCE_ROOT}/JsonCPP/dist"
diff --git a/layers/CMakeLists.txt b/layers/CMakeLists.txt
index 7a35df7ec..5543808e5 100644
--- a/layers/CMakeLists.txt
+++ b/layers/CMakeLists.txt
@@ -115,6 +115,7 @@ include_directories(
     ${CMAKE_CURRENT_BINARY_DIR}
     ${CMAKE_PROJECT_BINARY_DIR}
     ${CMAKE_BINARY_DIR}
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 if (WIN32)
diff --git a/layersvt/CMakeLists.txt b/layersvt/CMakeLists.txt
index c5eb9603d..62f1ca95e 100644
--- a/layersvt/CMakeLists.txt
+++ b/layersvt/CMakeLists.txt
@@ -111,6 +111,7 @@ include_directories(
     ${CMAKE_CURRENT_BINARY_DIR}
     ${CMAKE_BINARY_DIR}
     ${PROJECT_SOURCE_DIR}/../glslang/SPIRV
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 if (WIN32)
diff --git a/vktrace/vktrace_common/CMakeLists.txt b/vktrace/vktrace_common/CMakeLists.txt
index b7d6e33eb..c223912a9 100644
--- a/vktrace/vktrace_common/CMakeLists.txt
+++ b/vktrace/vktrace_common/CMakeLists.txt
@@ -7,6 +7,7 @@ set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/../)
 include_directories(
     ${SRC_DIR}/vktrace_common
     ${SRC_DIR}/thirdparty
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 if (${CMAKE_SYSTEM_NAME} MATCHES "Linux")
diff --git a/vktrace/vktrace_layer/CMakeLists.txt b/vktrace/vktrace_layer/CMakeLists.txt
index a99b53600..4c586bf2d 100644
--- a/vktrace/vktrace_layer/CMakeLists.txt
+++ b/vktrace/vktrace_layer/CMakeLists.txt
@@ -74,6 +74,7 @@ include_directories(
     ${VKTRACE_VULKAN_INCLUDE_DIR}
     ${CMAKE_BINARY_DIR}
     ${GENERATED_FILES_DIR}
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 # copy/link layer json file into build/layersvt directory
diff --git a/vktrace/vktrace_replay/CMakeLists.txt b/vktrace/vktrace_replay/CMakeLists.txt
index 8a84a58a2..6fdd51da9 100644
--- a/vktrace/vktrace_replay/CMakeLists.txt
+++ b/vktrace/vktrace_replay/CMakeLists.txt
@@ -66,6 +66,7 @@ include_directories(
     ${GENERATED_FILES_DIR}
     ${VKTRACE_VULKAN_INCLUDE_DIR}
     ${CMAKE_BINARY_DIR}
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 
diff --git a/vktrace/vktrace_trace/CMakeLists.txt b/vktrace/vktrace_trace/CMakeLists.txt
index 9e03b0961..a48ea6847 100644
--- a/vktrace/vktrace_trace/CMakeLists.txt
+++ b/vktrace/vktrace_trace/CMakeLists.txt
@@ -23,6 +23,7 @@ include_directories(
     ${VULKAN_TOOLS_SOURCE_DIR}/layersvt
     ${CMAKE_BINARY_DIR}
     ${GENERATED_FILES_DIR}
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 if (NOT WIN32)
-- 
2.11.1

