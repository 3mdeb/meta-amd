From ca8851884789af7841d96562c93ed3fddd602bcb Mon Sep 17 00:00:00 2001
From: Jammy Zhou <Jammy.Zhou@amd.com>
Date: Thu, 16 Jul 2015 10:29:58 +0800
Subject: [PATCH 62/67] amdgpu: add flags parameter for amdgpu_va_range_alloc
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

The flags is added for extensibility to cover some special requirements
in the future, i.e, request VA range in the first 4GB of address space

Signed-off-by: Jammy Zhou <Jammy.Zhou@amd.com>
Reviewed-by: Christian KÃ¶nig <christian.koenig@amd.com>
Signed-off-by: Arindam Nath <arindam.nath@amd.com>
---
 amdgpu/amdgpu.h       | 4 +++-
 amdgpu/amdgpu_vamgr.c | 3 ++-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/amdgpu/amdgpu.h b/amdgpu/amdgpu.h
index 125377c..bc6751a 100644
--- a/amdgpu/amdgpu.h
+++ b/amdgpu/amdgpu.h
@@ -1114,6 +1114,7 @@ int amdgpu_read_mm_registers(amdgpu_device_handle dev, unsigned dword_offset,
  * \param va_base_allocated - \c [out] On return: Allocated VA base to be used
  * by client.
  * \param va_range_handle - \c [out] On return: Handle assigned to allocation
+ * \param flags - \c [in] flags for special VA range
  *
  * \return 0 on success\n
  * >0 - AMD specific error code\n
@@ -1135,7 +1136,8 @@ int amdgpu_va_range_alloc(amdgpu_device_handle dev,
 			   uint64_t va_base_alignment,
 			   uint64_t va_base_required,
 			   uint64_t *va_base_allocated,
-			   amdgpu_va_handle *va_range_handle);
+			   amdgpu_va_handle *va_range_handle,
+			   uint64_t flags);
 
 /**
  * Free previously allocated virtual address range
diff --git a/amdgpu/amdgpu_vamgr.c b/amdgpu/amdgpu_vamgr.c
index d6ec9b4..ced4f4f 100644
--- a/amdgpu/amdgpu_vamgr.c
+++ b/amdgpu/amdgpu_vamgr.c
@@ -242,7 +242,8 @@ int amdgpu_va_range_alloc(amdgpu_device_handle dev,
 			  uint64_t va_base_alignment,
 			  uint64_t va_base_required,
 			  uint64_t *va_base_allocated,
-			  amdgpu_va_handle *va_range_handle)
+			  amdgpu_va_handle *va_range_handle,
+			  uint64_t flags)
 {
 	va_base_alignment = MAX2(va_base_alignment, dev->vamgr->va_alignment);
 	size = ALIGN(size, vamgr.va_alignment);
-- 
1.9.1

