From e8a91d40170b6a693b6f5c50943d221306ceae44 Mon Sep 17 00:00:00 2001
From: Vitaly Prosyak <vitaly.prosyak@amd.com>
Date: Tue, 31 May 2016 11:09:33 -0400
Subject: [PATCH 0531/1722] drm/amd/dal: free sync for dal

Added Makefile and fix compilation bugs

Signed-off-by: Vitaly Prosyak <vitaly.prosyak@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/modules/freesync/Makefile   | 10 ++++++++++
 drivers/gpu/drm/amd/dal/modules/freesync/freesync.c |  3 +--
 2 files changed, 11 insertions(+), 2 deletions(-)
 create mode 100644 drivers/gpu/drm/amd/dal/modules/freesync/Makefile

diff --git a/drivers/gpu/drm/amd/dal/modules/freesync/Makefile b/drivers/gpu/drm/amd/dal/modules/freesync/Makefile
new file mode 100644
index 0000000..c658c33
--- /dev/null
+++ b/drivers/gpu/drm/amd/dal/modules/freesync/Makefile
@@ -0,0 +1,10 @@
+#
+# Makefile for the 'freesync' sub-module of DAL.
+#
+
+FREESYNC = freesync.o
+
+AMD_DAL_FREESYNC = $(addprefix $(AMDDALPATH)/modules/freesync/,$(FREESYNC))
+#$(info ************  DAL-FREE SYNC_MAKEFILE ************)
+
+AMD_DAL_FILES += $(AMD_DAL_FREESYNC)
diff --git a/drivers/gpu/drm/amd/dal/modules/freesync/freesync.c b/drivers/gpu/drm/amd/dal/modules/freesync/freesync.c
index 5af723f..afb1183 100644
--- a/drivers/gpu/drm/amd/dal/modules/freesync/freesync.c
+++ b/drivers/gpu/drm/amd/dal/modules/freesync/freesync.c
@@ -27,7 +27,7 @@
 #include "dc.h"
 #include "mod_freesync.h"
 
-static const MOD_FREESYNC_MAX_CONCURRENT_SINKS = 32;
+#define MOD_FREESYNC_MAX_CONCURRENT_SINKS  32
 
 struct sink_caps {
         const struct dc_sink *sink;
@@ -143,7 +143,6 @@ void mod_freesync_destroy(struct mod_freesync *mod_freesync)
 bool mod_freesync_add_sink(struct mod_freesync *mod_freesync,
 		const struct dc_sink *sink, struct mod_freesync_caps *caps)
 {
-	int i = 0;
 	struct core_freesync *core_freesync =
 			MOD_FREESYNC_TO_CORE(mod_freesync);
 
-- 
2.7.4

