From 2e6cb6fdeef5d9fe583809d87c6f044df9a3c278 Mon Sep 17 00:00:00 2001
From: Harry Wentland <harry.wentland@amd.com>
Date: Thu, 25 Jun 2015 10:00:24 -0400
Subject: [PATCH 303/343] amd/dal: Clean up ASIC versions

Signed-off-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Sanjay R Mehta <sanju.mehta@amd.com>
---
 drivers/gpu/drm/amd/dal/adapter/adapter_service.c | 20 --------------------
 drivers/gpu/drm/amd/dal/encoder/digital_encoder.c |  1 -
 drivers/gpu/drm/amd/dal/encoder/encoder.c         | 10 ----------
 drivers/gpu/drm/amd/dal/include/dal_asic_id.h     |  3 ++-
 drivers/gpu/drm/amd/dal/include/dal_types.h       |  8 --------
 5 files changed, 2 insertions(+), 40 deletions(-)

diff --git a/drivers/gpu/drm/amd/dal/adapter/adapter_service.c b/drivers/gpu/drm/amd/dal/adapter/adapter_service.c
index e41ee0f..622dc4ab 100644
--- a/drivers/gpu/drm/amd/dal/adapter/adapter_service.c
+++ b/drivers/gpu/drm/amd/dal/adapter/adapter_service.c
@@ -894,28 +894,8 @@ enum dce_version dal_adapter_service_get_dce_version(
 	uint32_t version = as->asic_cap->data[ASIC_DATA_DCE_VERSION];
 
 	switch (version) {
-	case 0x80:
-		/* CI Bonaire */
-		return DCE_VERSION_8_0;
-	case 0x81:
-		/* Kaveri */
-		return DCE_VERSION_8_1;
-	case 0x83:
-		/* Kabini */
-		return DCE_VERSION_8_3;
-	case 0x85:
-		/* Mullins */
-		return DCE_VERSION_8_5;
-	case 0x100:
-		return DCE_VERSION_10_0;
-	case 0x101:
-		return DCE_VERSION_10_1;
-	case 0x102:
-		return DCE_VERSION_10_2;
 	case 0x110:
 		return DCE_VERSION_11_0;
-	case 0x111:
-		return DCE_VERSION_11_1;
 	default:
 		ASSERT_CRITICAL(false);
 		return DCE_VERSION_UNKNOWN;
diff --git a/drivers/gpu/drm/amd/dal/encoder/digital_encoder.c b/drivers/gpu/drm/amd/dal/encoder/digital_encoder.c
index 8418502..a6c8397 100644
--- a/drivers/gpu/drm/amd/dal/encoder/digital_encoder.c
+++ b/drivers/gpu/drm/amd/dal/encoder/digital_encoder.c
@@ -722,7 +722,6 @@ enum encoder_result dal_digital_encoder_create_hw_ctx(
 	switch (dce_version) {
 #if defined(CONFIG_DRM_AMD_DAL_DCE11_0)
 	case DCE_VERSION_11_0:
-	case DCE_VERSION_11_1:
 		enc->hw_ctx = dal_hw_ctx_digital_encoder_dce110_create(
 			init);
 	break;
diff --git a/drivers/gpu/drm/amd/dal/encoder/encoder.c b/drivers/gpu/drm/amd/dal/encoder/encoder.c
index f231ce9..a1e7925 100644
--- a/drivers/gpu/drm/amd/dal/encoder/encoder.c
+++ b/drivers/gpu/drm/amd/dal/encoder/encoder.c
@@ -222,7 +222,6 @@ static struct encoder_impl *create_digital_encoder_impl(
 		switch (dce_version) {
 #if defined(CONFIG_DRM_AMD_DAL_DCE11_0)
 		case DCE_VERSION_11_0:
-		case DCE_VERSION_11_1:
 			return dal_digital_encoder_uniphy_dce110_create(
 				init);
 #endif
@@ -238,7 +237,6 @@ static struct encoder_impl *create_digital_encoder_impl(
 		switch (dce_version) {
 #if defined(CONFIG_DRM_AMD_DAL_DCE11_0)
 		case DCE_VERSION_11_0:
-		case DCE_VERSION_11_1:
 			return dal_digital_encoder_dp_dce110_create(
 				init);
 #endif
@@ -251,7 +249,6 @@ static struct encoder_impl *create_digital_encoder_impl(
 		switch (dce_version) {
 #if defined(CONFIG_DRM_AMD_DAL_DCE11_0)
 		case DCE_VERSION_11_0:
-		case DCE_VERSION_11_1:
 			return dal_digital_encoder_edp_dce110_create(
 				init);
 #endif
@@ -278,13 +275,6 @@ static struct encoder_impl *create_analog_encoder_impl(
 				init->adapter_service);
 
 		switch (dce_version) {
-		case DCE_VERSION_8_1:
-		case DCE_VERSION_10_1:
-		case DCE_VERSION_11_1:
-			/* APU DCE 4.1, 6.1, 8.1, 11.1
-			 * does not support internal DAC */
-			BREAK_TO_DEBUGGER();
-			return NULL;
 		default:
 			/* CRT */
 			return dal_analog_encoder_crt_create(init);
diff --git a/drivers/gpu/drm/amd/dal/include/dal_asic_id.h b/drivers/gpu/drm/amd/dal/include/dal_asic_id.h
index aedde3f..83bf958 100644
--- a/drivers/gpu/drm/amd/dal/include/dal_asic_id.h
+++ b/drivers/gpu/drm/amd/dal/include/dal_asic_id.h
@@ -30,6 +30,7 @@
  * ASIC internal revision ID
  */
 
+/* DCE80 (based on ci_id.h in Perforce) */
 #define	CI_BONAIRE_M_A0 0x14
 #define	CI_BONAIRE_M_A1	0x15
 #define	CI_HAWAII_P_A0	0x28
@@ -39,7 +40,7 @@
 	((rev >= CI_BONAIRE_M_A0) && (rev < CI_HAWAII_P_A0))
 
 #define ASIC_REV_IS_HAWAII_P(rev) \
-	((rev >= CI_HAWAII_P_A0))
+	(rev >= CI_HAWAII_P_A0)
 
 /* KV1 with Spectre GFX core, 8-8-1-2 (CU-Pix-Primitive-RB) */
 #define KV_SPECTRE_A0 0x01
diff --git a/drivers/gpu/drm/amd/dal/include/dal_types.h b/drivers/gpu/drm/amd/dal/include/dal_types.h
index 9eb8059..095336a 100644
--- a/drivers/gpu/drm/amd/dal/include/dal_types.h
+++ b/drivers/gpu/drm/amd/dal/include/dal_types.h
@@ -30,15 +30,7 @@ struct dal_logger;
 
 enum dce_version {
 	DCE_VERSION_UNKNOWN = (-1),
-	DCE_VERSION_8_0,
-	DCE_VERSION_8_1,
-	DCE_VERSION_8_3,
-	DCE_VERSION_8_5,
-	DCE_VERSION_10_0,
-	DCE_VERSION_10_1,
-	DCE_VERSION_10_2,
 	DCE_VERSION_11_0,
-	DCE_VERSION_11_1,
 	DCE_VERSION_MAX
 };
 
-- 
1.9.1

