From 33a18063a16d0497088b517a1c81911a24fce963 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
Date: Sun, 25 Sep 2016 11:54:00 +0200
Subject: [PATCH 1049/1722] drm/amdgpu: fix addr handling in
 amdgpu_vm_bo_update_mapping
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Otherwise we will look at the wrong place in the IB when GART
mappings are split into smaller updates.

Signed-off-by: Christian KÃ¶nig <christian.koenig@amd.com>
Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
Acked-by: Tom StDenis <Tom.StDenis@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c
index ec576a1..06d69db 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c
@@ -1012,6 +1012,7 @@ static int amdgpu_vm_bo_update_mapping(struct amdgpu_device *adev,
                                                     AMDGPU_GPU_PAGE_SIZE);
                         pte[i] |= flags;
                 }
+		addr = 0;
         }
  
         r = amdgpu_sync_fence(adev, &job->sync, exclusive);
-- 
2.7.4

