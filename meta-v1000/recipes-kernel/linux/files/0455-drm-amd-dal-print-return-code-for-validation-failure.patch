From b47dd0b47c74ccb4ece03809b434b18c9ceda81f Mon Sep 17 00:00:00 2001
From: Eric Yang <eric.yang2@amd.com>
Date: Wed, 27 Apr 2016 16:20:58 -0400
Subject: [PATCH 0455/1722] drm/amd/dal: print return code for validation
 failure

Signed-off-by: Eric Yang <eric.yang2@amd.com>
Acked-by: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/dc/core/dc.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/drivers/gpu/drm/amd/dal/dc/core/dc.c b/drivers/gpu/drm/amd/dal/dc/core/dc.c
index 1fada66..253ac6c 100644
--- a/drivers/gpu/drm/amd/dal/dc/core/dc.c
+++ b/drivers/gpu/drm/amd/dal/dc/core/dc.c
@@ -464,6 +464,14 @@ bool dc_validate_resources(
 	dm_free(context);
 
 context_alloc_fail:
+	if (result != DC_OK) {
+		dal_logger_write(core_dc->ctx->logger,
+				LOG_MAJOR_INTERFACE_TRACE,
+				LOG_MINOR_COMPONENT_DC,
+				"%s:resource validation failed, dc_status:%d\n",
+				__func__,
+				result);
+	}
 
 	return (result == DC_OK);
 
@@ -756,6 +764,12 @@ bool dc_commit_targets(
 
 	result = core_dc->res_pool.funcs->validate_with_context(core_dc, set, target_count, context);
 	if (result != DC_OK){
+		dal_logger_write(core_dc->ctx->logger,
+					LOG_MAJOR_ERROR,
+					LOG_MINOR_COMPONENT_DC,
+					"%s: Context validation failed! dc_status:%d\n",
+					__func__,
+					result);
 		BREAK_TO_DEBUGGER();
 		resource_validate_ctx_destruct(context);
 		goto fail;
-- 
2.7.4

