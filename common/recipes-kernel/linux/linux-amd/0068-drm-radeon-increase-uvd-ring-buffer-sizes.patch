From 20c90286a08e09896b989d9d3de6ebe64be43adb Mon Sep 17 00:00:00 2001
From: Arindam Nath <arindam.nath@amd.com>
Date: Sun, 8 Feb 2015 03:41:56 +0530
Subject: [PATCH 9/9] drm/radeon: increase uvd ring buffer sizes

Signed-off-by: Leo Liu <leo.liu@amd.com>
Signed-off-by: Arindam Nath <arindam.nath@amd.com>
---
 drivers/gpu/drm/radeon/cik.c          | 2 +-
 drivers/gpu/drm/radeon/radeon_fence.c | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/radeon/cik.c b/drivers/gpu/drm/radeon/cik.c
index a35db40..f688ed6 100644
--- a/drivers/gpu/drm/radeon/cik.c
+++ b/drivers/gpu/drm/radeon/cik.c
@@ -7526,7 +7526,7 @@ int cik_init(struct radeon_device *rdev)
 	if (!r) {
 		ring = &rdev->ring[R600_RING_TYPE_UVD_INDEX];
 		ring->ring_obj = NULL;
-		r600_ring_init(rdev, ring, 4096);
+		r600_ring_init(rdev, ring, 256 * 1024);
 	}
 
 	r = radeon_vce_init(rdev);
diff --git a/drivers/gpu/drm/radeon/radeon_fence.c b/drivers/gpu/drm/radeon/radeon_fence.c
index 51760b7..eb54a79 100644
--- a/drivers/gpu/drm/radeon/radeon_fence.c
+++ b/drivers/gpu/drm/radeon/radeon_fence.c
@@ -626,6 +626,8 @@ int radeon_fence_wait_next_locked(struct radeon_device *rdev, int ring)
 	if (seq >= rdev->fence_drv[ring].sync_seq[ring]) {
 		/* nothing to wait for, last_seq is
 		   already the last emited fence */
+		printk("last_seq: %llx sync_seq: %llx\n", seq,
+			rdev->fence_drv[ring].sync_seq[ring]);
 		return -ENOENT;
 	}
 	return radeon_fence_wait_seq(rdev, seq, ring, false, false);
-- 
1.9.1

