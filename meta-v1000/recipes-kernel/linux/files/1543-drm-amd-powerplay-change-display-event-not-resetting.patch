From fc7ee06465beaa6b53e8d41bdb2cd3e19842ad09 Mon Sep 17 00:00:00 2001
From: Eric Huang <JinHuiEric.Huang@amd.com>
Date: Mon, 18 Apr 2016 13:51:45 -0400
Subject: [PATCH 1543/1722] drm/amd/powerplay: change display event not
 resetting dpm level to auto

Signed-off-by: Eric Huang <JinHuiEric.Huang@amd.com>

Change-Id: Ie6ff474b53f41f851703e0c6a214257fad7aa090
---
 drivers/gpu/drm/amd/powerplay/eventmgr/eventtasks.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/amd/powerplay/eventmgr/eventtasks.c b/drivers/gpu/drm/amd/powerplay/eventmgr/eventtasks.c
index b6f45fd..99890e8 100644
--- a/drivers/gpu/drm/amd/powerplay/eventmgr/eventtasks.c
+++ b/drivers/gpu/drm/amd/powerplay/eventmgr/eventtasks.c
@@ -41,7 +41,9 @@ int pem_task_update_allowed_performance_levels(struct pp_eventmgr *eventmgr, str
 	if (pem_is_hw_access_blocked(eventmgr))
 		return 0;
 
-	phm_force_dpm_levels(eventmgr->hwmgr, AMD_DPM_FORCED_LEVEL_AUTO);
+	if (eventmgr->hwmgr->dpm_level == AMD_DPM_FORCED_LEVEL_AUTO)
+		phm_force_dpm_levels(eventmgr->hwmgr,
+				AMD_DPM_FORCED_LEVEL_AUTO);
 
 	return 0;
 }
-- 
2.7.4

