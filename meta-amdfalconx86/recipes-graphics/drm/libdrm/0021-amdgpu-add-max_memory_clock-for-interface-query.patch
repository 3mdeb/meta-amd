From b9e0ac6113af43cacf7d7a23f4b4e2257d1e5c60 Mon Sep 17 00:00:00 2001
From: Ken Wang <Qingqing.Wang@amd.com>
Date: Wed, 3 Jun 2015 17:07:44 +0800
Subject: [PATCH 21/67] amdgpu: add max_memory_clock for interface query

Signed-off-by: Ken Wang <Qingqing.Wang@amd.com>
Reviewed-by: Jammy Zhou <Jammy.Zhou@amd.com>
Signed-off-by: Arindam Nath <arindam.nath@amd.com>
---
 amdgpu/amdgpu.h          | 2 ++
 amdgpu/amdgpu_gpu_info.c | 1 +
 include/drm/amdgpu_drm.h | 1 +
 3 files changed, 4 insertions(+)

diff --git a/amdgpu/amdgpu.h b/amdgpu/amdgpu.h
index c6161bd..17e5c1a 100644
--- a/amdgpu/amdgpu.h
+++ b/amdgpu/amdgpu.h
@@ -478,6 +478,8 @@ struct amdgpu_gpu_info {
 	uint64_t ids_flags;
 	/** max engine clock*/
 	uint64_t max_engine_clk;
+	/** max memory clock */
+	uint64_t max_memory_clk;
 	/** number of shader engines */
 	uint32_t num_shader_engines;
 	/** number of shader arrays per engine */
diff --git a/amdgpu/amdgpu_gpu_info.c b/amdgpu/amdgpu_gpu_info.c
index d46052e..7811b53 100644
--- a/amdgpu/amdgpu_gpu_info.c
+++ b/amdgpu/amdgpu_gpu_info.c
@@ -149,6 +149,7 @@ int amdgpu_query_gpu_info_init(amdgpu_device_handle dev)
 	dev->info.chip_external_rev = dev->dev_info.external_rev;
 	dev->info.family_id = dev->dev_info.family;
 	dev->info.max_engine_clk = dev->dev_info.max_engine_clock;
+	dev->info.max_memory_clk = dev->dev_info.max_memory_clock;
 	dev->info.gpu_counter_freq = dev->dev_info.gpu_counter_freq;
 	dev->info.enabled_rb_pipes_mask = dev->dev_info.enabled_rb_pipes_mask;
 	dev->info.rb_pipes = dev->dev_info.num_rb_pipes;
diff --git a/include/drm/amdgpu_drm.h b/include/drm/amdgpu_drm.h
index 1331159..4d96bcf 100644
--- a/include/drm/amdgpu_drm.h
+++ b/include/drm/amdgpu_drm.h
@@ -553,6 +553,7 @@ struct drm_amdgpu_info_device {
 	uint32_t num_shader_arrays_per_engine;
 	uint32_t gpu_counter_freq; /* in KHz */
 	uint64_t max_engine_clock; /* in KHz */
+	uint64_t max_memory_clock;   /* in KHz */
 	/* cu information */
 	uint32_t cu_active_number;
 	uint32_t cu_ao_mask;
-- 
1.9.1

