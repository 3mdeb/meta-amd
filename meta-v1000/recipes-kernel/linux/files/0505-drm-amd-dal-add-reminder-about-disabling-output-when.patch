From 77e1dc3c8c30a0f52f4b7d198e3d2af118a2251e Mon Sep 17 00:00:00 2001
From: Eric Yang <eric.yang2@amd.com>
Date: Thu, 19 May 2016 16:03:44 -0400
Subject: [PATCH 0505/1722] drm/amd/dal: add reminder about disabling output
 when clock sources change

Signed-off-by: Eric Yang <eric.yang2@amd.com>
Acked-by: Jordan Lazare <Jordan.Lazare@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Kalyan Alle <kalyan.alle@amd.com>
---
 drivers/gpu/drm/amd/dal/dc/core/dc_resource.c | 5 +++++
 drivers/gpu/drm/amd/dal/dc/inc/resource.h     | 4 ----
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/drivers/gpu/drm/amd/dal/dc/core/dc_resource.c b/drivers/gpu/drm/amd/dal/dc/core/dc_resource.c
index d7e2ba4..809f6f16 100644
--- a/drivers/gpu/drm/amd/dal/dc/core/dc_resource.c
+++ b/drivers/gpu/drm/amd/dal/dc/core/dc_resource.c
@@ -1453,6 +1453,11 @@ static bool check_timing_change(struct core_stream *cur_stream,
 		sizeof(struct dc_crtc_timing)) != 0;
 }
 
+/*
+ * Note: We need to disable output if clock sources change,
+ * since bios does optimization and doesn't apply if changing
+ * PHY when not already disabled.
+ */
 bool pipe_need_reprogram(
 		struct pipe_ctx *pipe_ctx_old,
 		struct pipe_ctx *pipe_ctx)
diff --git a/drivers/gpu/drm/amd/dal/dc/inc/resource.h b/drivers/gpu/drm/amd/dal/dc/inc/resource.h
index 1222466..ad6a196 100644
--- a/drivers/gpu/drm/amd/dal/dc/inc/resource.h
+++ b/drivers/gpu/drm/amd/dal/dc/inc/resource.h
@@ -47,10 +47,6 @@ enum dc_status resource_map_pool_resources(
 		const struct core_dc *dc,
 		struct validate_context *context);
 
-enum dc_status resource_map_vmin_resources(
-		const struct core_dc *dc,
-		struct validate_context *context);
-
 void resource_build_scaling_params(
 		const struct dc_surface *surface,
 		struct pipe_ctx *pipe_ctx);
-- 
2.7.4

